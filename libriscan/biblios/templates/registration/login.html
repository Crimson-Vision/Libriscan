{% extends "biblios/base.html" %}

{% block content %}
<main class="min-h-screen bg-gradient-to-br from-primary/10 via-base-200 to-secondary/10 pt-24 flex items-start justify-center px-4">
  <div class="card bg-base-100 shadow-2xl border border-base-300 w-full max-w-md mt-8">
    <form method="post" action="{% url 'login' %}" class="card-body" aria-label="Login form" role="form">
      <h1 class="text-2xl font-bold text-primary mb-1">Welcome Back</h1>
      <p class="text-sm text-base-content/70 mb-6">Sign in to access your document library</p>

      {% csrf_token %}

      {% if form.errors %}
      <div class="alert alert-error mb-4" id="login-error" role="alert" aria-live="assertive" aria-atomic="true">
        <span>Your username and password didn't match. Please try again.</span>
      </div>
      {% endif %}

      {% if next %}
        {% if user.is_authenticated %}
        <div class="alert alert-warning mb-4" role="alert" aria-live="polite" aria-atomic="true">
          <span>Your account doesn't have access to this page. Please login with an account that has access.</span>
        </div>
        {% else %}
        <div class="alert alert-info mb-4" role="alert" aria-live="polite" aria-atomic="true">
          <span>Please login to see this page.</span>
        </div>
        {% endif %}
      {% endif %}

      <div class="form-control mb-4">
        <label class="label" for="{{ form.username.id_for_label }}">
          <span class="label-text font-semibold">Username</span>
        </label>
        <input 
          type="text" 
          name="username" 
          class="input input-bordered w-full" 
          id="{{ form.username.id_for_label }}" 
          placeholder="Enter your username" 
          required 
          autofocus
          aria-required="true"
          aria-describedby="{% if form.errors %}login-error{% endif %} username-help"
          aria-label="Username"
        >
        <span id="username-help" class="sr-only">Enter your username to sign in</span>
      </div>

      <div class="form-control mb-4">
        <label class="label" for="{{ form.password.id_for_label }}">
          <span class="label-text font-semibold">Password</span>
        </label>
        <input 
          type="password" 
          name="password" 
          class="input input-bordered w-full" 
          id="{{ form.password.id_for_label }}" 
          placeholder="Enter your password" 
          required
          aria-required="true"
          aria-describedby="{% if form.errors %}login-error{% endif %} password-help"
          aria-label="Password"
        >
        <span id="password-help" class="sr-only">Enter your password to sign in</span>
      </div>

      <div class="flex justify-end mb-4">
        <a href="{% url 'password_reset' %}" class="link link-hover text-sm text-primary" aria-label="Reset your forgotten password">Forgot password?</a>
      </div>

      <input type="hidden" name="next" value="{{ next }}">
      <button class="btn btn-primary w-full" type="submit" aria-label="Sign in to your account">Login</button>
    </form>
  </div>
</main>
{% endblock %}
