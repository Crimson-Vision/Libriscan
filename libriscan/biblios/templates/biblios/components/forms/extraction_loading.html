{% load static %}
<!-- Extraction Loading Animation Component -->
<div id="extractPrompt" 
     class="card bg-base-100 shadow-sm h-full"
     hx-get="{% url 'page_words' short_name collection_slug identifier number %}"
     hx-trigger="load, every 2s"
     hx-swap="outerHTML">
  <div class="card-body flex flex-col justify-start items-center h-full text-center p-8 pt-16">
    <!-- Hero Section -->
    <div class="hero-content text-center">
      <div class="max-w-md">
        <div class="avatar placeholder mb-6">
          <div class="bg-primary text-primary-content rounded-full w-20 flex items-center justify-center">
            <img src="{% static 'svg/loading.svg' %}" alt="Loading..." class="w-12 h-12">
          </div>
        </div>

        <div class="flex justify-center mb-4">
          <div class="badge badge-primary badge-outline flex items-center justify-center gap-2 px-4 py-3 text-md">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-3">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z" />
            </svg>
            Extracting...
          </div>
        </div>

        <div class="alert alert-info shadow-lg">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-8">
            <path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z" />
          </svg>
          <div>
            <h3 class="font-bold">Processing Status</h3>
            <div class="text-xs">
              <p id="rotatingText" class="text-info-content" style="transition: opacity 0.3s ease-in-out;">
                Extracting text from the page image.
              </p>
            </div>
          </div>
        </div>
        <!-- @TODO: We can dynamically update details of engine/mode/status if we want -->
        <div class="mockup-code bg-base-200 text-left mb-6">
          <pre data-prefix=">" class="text-success"><code>Status: Processing document...</code></pre>
          <pre data-prefix=">" class="text-warning"><code>Engine Provider: {{ owner.cloudservice }}</code></pre>
          <pre data-prefix=">" class="text-info"><code>Mode: High accuracy extraction</code></pre>
        </div>
        <p class="text-sm text-base-content/60 mt-4">
          This process typically takes 15-30 seconds for optimal results
        </p>
      </div>
    </div>
  </div>
</div>

<script>
(() => {
  const phrases = [
    "Extracting text from the page image.",
    "Analyzing document structure and layout...",
    "Processing optical character recognition...",
    "Identifying words and formatting...",
    "Extracting text with confidence scores...",
    "Detecting historical typography patterns...",
    "Building searchable text representation..."
  ];
  
  let index = 0;
  
  function rotateText() {
    const el = document.getElementById('rotatingText');
    if (!el) return;
    
    el.style.opacity = '0';
    setTimeout(() => {
      index = (index + 1) % phrases.length;
      el.textContent = phrases[index];
      el.style.opacity = '1';
    }, 300);
  }
  
  // Start rotation after 1 second, then every 2.5 seconds
  setTimeout(() => setInterval(rotateText, 2500), 1000);
})();
</script>
