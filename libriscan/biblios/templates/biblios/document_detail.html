{% extends "biblios/base.html" %}
{% load static %}
{% block content %}
        <!-- Breadcrumb Navigation with Icons -->
        <nav class="mb-3 text-sm breadcrumbs">
            <ul>
          <li>
              <a href="{{ document.collection.owner.get_absolute_url }}" class="flex items-center gap-1 hover:underline text-primary">
              <span class="inline-flex items-center justify-center size-5 rounded bg-primary/10">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4 text-primary">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 21v-8.25M15.75 21v-8.25M8.25 21v-8.25M3 9l9-6 9 6m-1.5 12V10.332A48.36 48.36 0 0 0 12 9.75c-2.551 0-5.056.2-7.5.582V21M3 21h18M12 6.75h.008v.008H12V6.75Z" />
                </svg>
              </span>
            {{ document.collection.owner }}
              </a>
          </li>
          <li>
              <a href="{{ document.collection.get_absolute_url }}" class="flex items-center gap-1 hover:underline text-primary">
            <span class="inline-flex items-center justify-center size-5 rounded bg-accent/10">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4 text-accent">
              <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 10h16M4 14h16M4 18h16" />
                </svg>
            </span>
            {{ document.collection }}
              </a>
          </li>
          {% if document.series %}
          <li>
              <a href="{{ document.series.get_absolute_url }}" class="flex items-center gap-1 hover:underline text-primary">
              <span class="inline-flex items-center justify-center size-5 rounded bg-secondary/10">
                <svg xmlns="http://www.w3.org/2000/svg" class="size-4 text-secondary" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z" /></svg>
              </span>
            {{ document.series }}
              </a>
          </li>
          {% endif %}
          <li>
              <span class="flex items-center gap-1 text-base-content/60">
            <span class="inline-flex items-center justify-center size-5 rounded bg-warning/20">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4 text-neutral">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" />
                </svg>
            </span>
            {{ document }}
              </span>
          </li>
        </ul>
      </nav>

        <!-- Document Header Card -->
        <div class="card bg-base-100 shadow mb-6">
            <div class="card-body">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-3 flex-1">
                        <h2 class="card-title text-xl font-bold flex items-center gap-2">
                            <span class="inline-flex items-center justify-center size-8 rounded-full bg-warning/20">
                              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" />
                              </svg>
                            </span>
                            {{ document }}
                            <a href="{% url 'document_update' keys.owner keys.collection_slug document.identifier %}" 
                               class="btn btn-ghost btn-xs tooltip tooltip-right"
                               data-tip="Edit title">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
                                </svg>
                            </a>
                        </h2>
                        <!-- Status Dropdown -->
                        {% include "biblios/components/status/status_dropdown.html" %}
                    </div>
                    <button 
                        type="button" 
                        class="btn btn-ghost btn-sm btn-error tooltip tooltip-left"
                        data-tip="Delete document"
                        onclick="showDeleteDocumentModal('{{ document.identifier }}', '{% url 'document_delete' keys.owner keys.collection_slug document.identifier %}')">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                            <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
                        </svg>
                    </button>
                </div>
                
                <!-- Pages Section -->
                <div class="mb-2 text-base font-semibold text-base-content/80">Pages in this document:</div>
                  <ul class="bg-base-100 rounded-box shadow divide-base-200">
                    {% for page in document.pages.all %}
                      <li class="px-4 py-3 flex items-center justify-between hover:bg-secondary/10 transition rounded-box">
                        <a href="{{ page.get_absolute_url }}" class="flex items-center gap-3 group flex-1">
                          <span class="inline-flex items-center justify-center size-6 rounded bg-info/10">
                            <span class="text-xs font-medium text-info">{{ page.number }}</span>
                          </span>
                          <span class="text-sm font-medium group-hover:underline">Page {{ page.number }}</span>
                        </a>
                        <button 
                          type="button" 
                          class="btn btn-ghost btn-sm btn-error ml-2 tooltip tooltip-left"
                          data-tip="Delete page"
                          onclick="showDeletePageModal({{ page.number }}, '{% url 'page_delete' keys.owner keys.collection_slug document.identifier page.number %}')">
                          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                            <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
                          </svg>
                        </button>
                      </li>
                    {% empty %}
                      <li class="px-4 py-3 text-center text-sm opacity-60">No pages in this document yet.</li>
                    {% endfor %}
                  </ul>
                  <div class="mt-4 flex justify-end">
                      <a href="{% url 'page_create' keys.owner keys.collection_slug document.identifier %}" class="btn btn-secondary btn-md">
                          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m3.75 9v6m3-3H9m1.5-12H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
                          </svg></svg>
                          Add New Page
                      </a>
                  </div>
                </div>

                <!-- Downloads Export Section -->
                <div>
                    <div class="mb-3 text-base font-semibold text-base-content/80 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="size-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" /></svg>
                        Export options:
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
                        <a href="{% url 'export_pdf' keys.owner keys.collection_slug document.identifier %}" class="btn btn btn-error btn-sm justify-start">
                            <svg xmlns="http://www.w3.org/2000/svg" class="size-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                            PDF with Images
                        </a>
                        <a href="{% url 'export_textpdf' keys.owner keys.collection_slug document.identifier %}" class="btn btn btn-warning btn-sm justify-start">
                            <svg xmlns="http://www.w3.org/2000/svg" class="size-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                            Text-only PDF
                        </a>
                        <a href="{% url 'export_text' keys.owner keys.collection_slug document.identifier %}" class="btn btn btn-success btn-sm justify-start">
                            <svg xmlns="http://www.w3.org/2000/svg" class="size-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                            Plain Text
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Delete Document Confirmation Modal -->
        {% include "biblios/components/delete_document_modal.html" %}

        <!-- Delete Page Confirmation Modal -->
        {% include "biblios/components/delete_page_modal.html" %}

<!-- Status Dropdown Script -->
<script src="{% static 'js/document_status.js' %}"></script>
<script>
    // Initialize status dropdown when page loads
    document.addEventListener('DOMContentLoaded', function() {
        const currentStatus = '{{ document.status }}';
        window.initStatusDropdown(currentStatus);
    });
</script>
{% endblock content %}
